unit ordemproducaoimprimiretiquetaapontamentocorrigir_unit;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Mask, Vcl.DBCtrls,
  Vcl.Buttons, Vcl.ExtCtrls;

type
  TOrdemProducao_ImprimirEtiquetaApontamento_Corrigir = class(TForm)
    Panel6: TPanel;
    Panel7: TPanel;
    Image2: TImage;
    SpeedButton2: TSpeedButton;
    Image4: TImage;
    SpeedButton4: TSpeedButton;
    Panel_Titulo: TPanel;
    Image6: TImage;
    LBL_Titulo: TLabel;
    Panel1: TPanel;
    Label2: TLabel;
    Label1: TLabel;
    Label3: TLabel;
    TXT_HoraIni: TMaskEdit;
    TXT_HoraFim: TMaskEdit;
    Label4: TLabel;
    Label5: TLabel;
    TXT_Operador: TEdit;
    LBL_Recno: TLabel;
    Label6: TLabel;
    TXT_Dosagem: TEdit;
    TXT_Peso: TEdit;
    TXT_Ciclo: TEdit;
    procedure SpeedButton4Click(Sender: TObject);
    procedure SpeedButton2Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  OrdemProducao_ImprimirEtiquetaApontamento_Corrigir: TOrdemProducao_ImprimirEtiquetaApontamento_Corrigir;

implementation

{$R *.dfm}

uses OrdemProducaoImprimirEtiquetaApontamento_Unit;

procedure TOrdemProducao_ImprimirEtiquetaApontamento_Corrigir.SpeedButton2Click(
  Sender: TObject);

  Var
     VLC_Select : String;
begin

    VLC_Select := VLC_Select + ' Update P12OFICIAL.dbo.SH6010 ' + #13;
    VLC_Select := VLC_Select + ' Set H6_FSPESOI = ' + '''' + StringReplace(FloatToStr((StrToFloat(TXT_Peso.Text))), ',', '.', [rfReplaceAll, rfIgnoreCase]) + '''' + ',' + #13;
    VLC_Select := VLC_Select + ' H6_FSDOSAG = ' + '''' + StringReplace(FloatToStr((StrToFloat(TXT_Dosagem.Text))), ',', '.', [rfReplaceAll, rfIgnoreCase]) + '''' + ',' + #13;
    VLC_Select := VLC_Select + ' H6_OPERADO = ' + '''' + TXT_Operador.Text + '''' + #13;
    VLC_Select := VLC_Select + ' H6_CICLO = ' + '''' + StringReplace(FloatToStr((StrToFloat(TXT_Ciclo.Text))), ',', '.', [rfReplaceAll, rfIgnoreCase]) + '''' + ',' + #13;
    VLC_Select := VLC_Select + ' H6_HORAINI = ' + '''' + TXT_HoraIni.Text + '''' + #13;
    VLC_Select := VLC_Select + ' H6_HORAFIN = ' + '''' + TXT_HoraFim.Text + '''' + #13;
    VLC_Select := VLC_Select + ' Where R_E_C_N_O_ = ' + LBL_Recno.Caption;

    OrdemProducao_ImprimirEtiquetaApontamento.Memo2.Lines.Text := '';
    OrdemProducao_ImprimirEtiquetaApontamento.Memo2.Lines.Text := VLC_Select;

    Close;

end;

procedure TOrdemProducao_ImprimirEtiquetaApontamento_Corrigir.SpeedButton4Click(
  Sender: TObject);
begin
  Close;
end;

end.
